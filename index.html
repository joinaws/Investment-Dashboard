<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>InvestAdmin — Tailwind Premium Admin</title>

  <!-- Tailwind Play CDN (quick dev) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    /* Small extra styles to mimic depth & fixed header look */
    .sidebar-bg { background: linear-gradient(180deg,#071028 0%, #0f1724 100%); }
    .glass { background: rgba(255,255,255,0.04); }
    /* Make chart canvases fill container */
    .chart-area { min-height: 260px; height: 100%; }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 antialiased">
  <div class="min-h-screen grid lg:grid-cols-[260px_1fr] gap-6 p-6">
    <!-- SIDEBAR -->
    <aside class="sidebar-bg text-sky-50 rounded-2xl p-5 shadow-lg flex flex-col gap-6">
      <div class="flex items-center gap-3">
        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-sky-500 to-sky-400 flex items-center justify-center font-semibold drop-shadow-lg">INV</div>
        <div>
          <h1 class="text-lg font-semibold">InvestAdmin</h1>
          <p class="text-sm text-sky-200">Premium Panel</p>
        </div>
      </div>

      <nav class="flex flex-col gap-2" aria-label="Main navigation">
        <a href="#overview" class="nav-link flex items-center gap-3 px-3 py-3 rounded-lg bg-white/3 text-white font-medium active" data-key="overview">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3v10zM3 21h8v-6H3v6zM13 21h8V11h-8v10zM13 3v6h8V3h-8z"/></svg>
          Overview
        </a>
        <a href="#investments" class="nav-link flex items-center gap-3 px-3 py-3 rounded-lg text-sky-100 hover:bg-white/4" data-key="investments">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3v10z"/></svg>
          Investments
        </a>
        <a href="#reports" class="nav-link flex items-center gap-3 px-3 py-3 rounded-lg text-sky-100 hover:bg-white/4" data-key="reports">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3 7h7l-5.5 4 2 7L12 16l-6.5 4 2-7L2 9h7l3-7z"/></svg>
          Reports
        </a>
        <a href="#team" class="nav-link flex items-center gap-3 px-3 py-3 rounded-lg text-sky-100 hover:bg-white/4" data-key="team">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.7 0 8 1.3 8 4v2H4v-2c0-2.7 5.3-4 8-4zM12 2a4 4 0 110 8 4 4 0 010-8z"/></svg>
          Team
        </a>
      </nav>

      <div class="mt-auto text-xs text-sky-200">Version 1.2 • Last updated: Nov 28, 2025</div>
    </aside>

    <!-- MAIN -->
    <main class="space-y-6">
      <!-- TOPBAR -->
      <div class="flex items-center justify-between gap-4">
        <div class="flex items-center gap-4 w-full max-w-2xl">
          <div class="flex items-center gap-2 bg-white rounded-xl shadow p-2 w-full">
            <svg class="w-5 h-5 text-slate-400 ml-2" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <input id="globalSearch" class="w-full outline-none text-sm px-2 bg-transparent" placeholder="Search month or amount (e.g. Jan-25 or 45000)" />
          </div>
        </div>

        <div class="flex items-center gap-3">
          <div class="text-right">
            <div class="font-semibold">Puneet</div>
            <div class="text-xs text-slate-500">Admin</div>
          </div>
          <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-slate-500 to-slate-400 flex items-center justify-center text-white font-semibold">P</div>
        </div>
      </div>

      <!-- HERO -->
      <section id="overview" class="rounded-2xl p-5 bg-gradient-to-r from-sky-600 to-sky-500 text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <h2 class="text-xl font-semibold">Investment Dashboard</h2>
            <p class="text-sm opacity-90">Overview of contributions, expenses and current balance — Premium Admin</p>
          </div>
          <div class="flex gap-2">
            <button id="exportCsv" class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 font-semibold">Export CSV</button>
            <button class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20">Add Entry</button>
          </div>
        </div>
      </section>

      <!-- KPI SUMMARY -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="bg-white rounded-2xl p-4 shadow">
          <div class="text-sm text-slate-400">Total Investment</div>
          <div id="totalInvestment" class="text-2xl font-bold mt-2">—</div>
          <div class="text-xs text-slate-400 mt-1">All contributors</div>
        </div>
        <div class="bg-white rounded-2xl p-4 shadow">
          <div class="text-sm text-slate-400">Total Expenses</div>
          <div id="totalExpenses" class="text-2xl font-bold mt-2">—</div>
          <div class="text-xs text-slate-400 mt-1">Fixed & variable</div>
        </div>
        <div class="bg-white rounded-2xl p-4 shadow">
          <div class="text-sm text-slate-400">Available Balance</div>
          <div id="availableBalance" class="text-2xl font-bold mt-2">—</div>
          <div class="text-xs text-slate-400 mt-1">After expenses</div>
        </div>
      </div>

      <!-- CONTENT GRID -->
      <div class="grid grid-cols-1 lg:grid-cols-[1fr_420px] gap-6">
        <!-- Left: Investments table -->
        <section id="investments" class="bg-white rounded-2xl p-4 shadow overflow-auto">
          <div class="flex items-center justify-between mb-3">
            <h3 class="font-semibold">Investment Details</h3>
            <div class="flex items-center gap-2">
              <label class="text-sm text-slate-500">Filter:</label>
              <select id="monthFilter" class="px-2 py-1 rounded border text-sm">
                <option value="">All months</option>
              </select>
            </div>
          </div>

          <div class="overflow-x-auto">
            <table id="investmentTable" class="min-w-full text-sm">
              <thead class="text-slate-500">
                <tr>
                  <th class="text-left p-2">Month</th>
                  <th class="text-left p-2">Pankaj (₹)</th>
                  <th class="text-left p-2">Puneet (₹)</th>
                  <th class="text-left p-2">Lucky (₹)</th>
                  <th class="text-left p-2">Total (₹)</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <div class="flex items-center justify-between mt-3">
            <div class="text-xs text-slate-500">Showing <span id="rowsCount">0</span> rows</div>
            <div class="flex items-center gap-3">
              <div class="text-xs text-slate-500">Grand Total:</div>
              <div id="grandTotal" class="px-3 py-1 rounded bg-sky-50 text-sky-700 font-semibold">—</div>
            </div>
          </div>
        </section>

        <!-- Right: Reports (charts) -->
        <aside id="reports" class="bg-white rounded-2xl p-4 shadow flex flex-col gap-4">
          <h3 class="font-semibold">Reports</h3>

          <div class="bg-slate-50 rounded-xl p-3 flex-1">
            <div class="text-sm text-slate-600 mb-2">Monthly Contributions (stacked)</div>
            <div class="chart-area">
              <canvas id="contributionsChart"></canvas>
            </div>
          </div>

          <div class="bg-slate-50 rounded-xl p-3">
            <div class="flex items-center justify-between mb-2">
              <div class="text-sm text-slate-600">Expense Breakdown</div>
              <div id="topExpense" class="text-sm text-sky-600 font-semibold"></div>
            </div>
            <div class="chart-area h-40">
              <canvas id="expensesChart"></canvas>
            </div>
          </div>
        </aside>
      </div>

      <!-- TEAM SECTION -->
      <section id="team" class="bg-white rounded-2xl p-4 shadow">
        <h3 class="font-semibold">Team</h3>
        <p class="text-sm text-slate-500 mt-2">Members and roles (placeholder)</p>
      </section>
    </main>
  </div>

  <script>
    /***********************
     * Full data (original months)
     ***********************/
    const investmentData = [
      { month: 'Jan-23', pankaj: 0, puneet: 0, lucky: 20000, total: 20000, note: 'Pankaj Received 20000' },
      { month: 'Feb-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Mar-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Apr-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'May-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Jun-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Jul-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Aug-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Sep-23', pankaj: 0, puneet: 0, lucky: 0, total: 0 },
      { month: 'Oct-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Nov-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Dec-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Jan-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Feb-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Mar-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Apr-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'May-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Jun-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
      { month: 'Jul-24', pankaj: 0, puneet: 0, lucky: 0, total: 0 },
      { month: 'Aug-24', pankaj: 0, puneet: 0, lucky: 0, total: 0 },
      { month: 'Sep-24', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Oct-24', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Nov-24', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Dec-24', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Jan-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Feb-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Mar-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Apr-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'May-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Jun-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Jul-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Aug-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Sep-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 },
      { month: 'Oct-25', pankaj: 15000, puneet: 15000, lucky: 15000, total: 45000 }
    ];

    const expenseData = [
      { category: 'Shiwpur Khet Me', amount: 280000 },
      { category: 'Pankaj (Delhi Home Loan)', amount: 126000 },
      { category: 'Mitti', amount: 4000 },
      { category: 'Ghar ki Battery', amount: 3700 },
      { category: 'Ped ki katai', amount: 1300 }
    ];

    /***********************
     * Helpers
     ***********************/
    const formatINR = n => '₹' + Number(n).toLocaleString('en-IN');

    /***********************
     * Render Table & KPIs
     ***********************/
    const tbody = document.querySelector('#investmentTable tbody');
    const monthFilter = document.getElementById('monthFilter');
    const rowsCount = document.getElementById('rowsCount');
    const grandTotalEl = document.getElementById('grandTotal');

    function renderTable(filter='') {
      tbody.innerHTML = '';
      const filtered = investmentData.filter(r => {
        if (!filter) return true;
        return r.month.toLowerCase().includes(filter.toLowerCase());
      });
      filtered.forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="p-2">${r.month}${r.note?'<div class="text-xs text-slate-500 mt-1">'+r.note+'</div>':''}</td>
          <td class="p-2">${formatINR(r.pankaj)}</td>
          <td class="p-2">${formatINR(r.puneet)}</td>
          <td class="p-2">${formatINR(r.lucky)}</td>
          <td class="p-2"><span class="px-2 py-1 rounded bg-sky-50 text-sky-700 font-semibold">${formatINR(r.total)}</span></td>
        `;
        tbody.appendChild(tr);
      });
      rowsCount.textContent = filtered.length;
      const grand = filtered.reduce((s,x)=>s+x.total,0);
      grandTotalEl.textContent = formatINR(grand);
    }

    (function populateMonthFilter(){
      const months = [...new Set(investmentData.map(d=>d.month))];
      months.forEach(m=>{
        const opt = document.createElement('option');
        opt.value = m;
        opt.textContent = m;
        monthFilter.appendChild(opt);
      });
    })();

    // Summary KPIs
    const totalInvestment = investmentData.reduce((s,x)=>s+x.total,0);
    const totalExpenses = expenseData.reduce((s,x)=>s+x.amount,0);
    const availableBalance = totalInvestment - totalExpenses;

    document.getElementById('totalInvestment').textContent = formatINR(totalInvestment);
    document.getElementById('totalExpenses').textContent = formatINR(totalExpenses);
    document.getElementById('availableBalance').textContent = formatINR(availableBalance);

    renderTable();

    monthFilter.addEventListener('change', (e)=> renderTable(e.target.value));
    document.getElementById('globalSearch').addEventListener('input', (e)=> renderTable(e.target.value));

    /***********************
     * Charts (Chart.js)
     ***********************/
    const labels = investmentData.map(d=>d.month);
    const pankajData = investmentData.map(d=>d.pankaj);
    const puneetData = investmentData.map(d=>d.puneet);
    const luckyData = investmentData.map(d=>d.lucky);

    const ctxC = document.getElementById('contributionsChart').getContext('2d');
    const contributionsChart = new Chart(ctxC, {
      type: 'bar',
      data: {
        labels,
        datasets: [
          { label: 'Pankaj', data: pankajData, backgroundColor: '#0b6cff' },
          { label: 'Puneet', data: puneetData, backgroundColor: '#06b6d4' },
          { label: 'Lucky', data: luckyData, backgroundColor: '#f97316' }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          tooltip: {
            callbacks: {
              label: ctx => `${ctx.dataset.label}: ${formatINR(ctx.raw)}`
            }
          },
          legend: { position: 'top' }
        },
        scales: {
          x: { stacked: true, ticks: { maxRotation: 45, minRotation: 0 } },
          y: { stacked: true, beginAtZero: true, title: { display: true, text: 'Amount (₹)' } }
        }
      }
    });

    // Expenses
    const expenseLabels = expenseData.map(e => e.category);
    const expenseAmounts = expenseData.map(e => e.amount);
    const expenseColors = ['#7c3aed','#0b6cff','#f59e0b','#ef4444','#10b981'];
    const totalExpense = expenseAmounts.reduce((a,b)=>a+b,0);
    document.getElementById('topExpense').textContent = `${expenseData[0].category} • ${formatINR(expenseData[0].amount)}`;

    const ctxE = document.getElementById('expensesChart').getContext('2d');
    const expensesChart = new Chart(ctxE, {
      type: 'doughnut',
      data: { labels: expenseLabels, datasets: [{ data: expenseAmounts, backgroundColor: expenseColors }] },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'bottom' },
          tooltip: {
            callbacks: {
              label: ctx => {
                const v = ctx.raw;
                const pct = ((v/totalExpense)*100).toFixed(1);
                return `${ctx.label}: ${formatINR(v)} (${pct}%)`;
              }
            }
          }
        }
      }
    });

    /***********************
     * Export CSV
     ***********************/
    document.getElementById('exportCsv').addEventListener('click', () => {
      const headers = ['Month','Pankaj','Puneet','Lucky','Total'];
      const rows = investmentData.map(r => [r.month, r.pankaj, r.puneet, r.lucky, r.total]);
      let csv = headers.join(',') + '\n' + rows.map(r => r.join(',')).join('\n');
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'investment-data.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    /***********************
     * Sidebar navigation (active + smooth scroll)
     ***********************/
    document.querySelectorAll('.nav-link').forEach(link=>{
      link.addEventListener('click', e=>{
        e.preventDefault();
        document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));
        link.classList.add('active');
        const target = document.querySelector(link.getAttribute('href'));
        if(target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        if(window.innerWidth < 900){
          // small screen: briefly hide sidebar for UX
          document.querySelector('.sidebar-bg').classList.add('hidden');
          setTimeout(()=> document.querySelector('.sidebar-bg').classList.remove('hidden'), 350);
        }
      });
    });

    /* Responsive: redraw charts on resize for better fit */
    window.addEventListener('resize', ()=> {
      contributionsChart.resize();
      expensesChart.resize();
    });
  </script>
</body>
</html>
