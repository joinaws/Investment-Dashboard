<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Investment Dashboard — Final</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background:#f5f7fa; color:#222; padding:20px; }
        .container { max-width:1150px; margin:0 auto; }
        header { background:linear-gradient(135deg,#2c3e50,#4a6491); color:#fff; padding:20px; border-radius:10px; text-align:center; margin-bottom:20px; }
        header h1 { font-size:1.6rem; margin-bottom:6px; }
        header p { opacity:0.9; margin-top:2px; }

        .summary { display:grid; grid-template-columns:repeat(3,1fr); gap:16px; margin:18px 0; }
        .card-sm { background:#fff; padding:14px; border-radius:10px; text-align:center; box-shadow:0 6px 14px rgba(0,0,0,0.05); }
        .card-sm h3 { font-size:0.9rem; color:#666; margin-bottom:6px; }
        .card-sm .amt { font-size:1.6rem; font-weight:700; }
        .card-sm.total .amt { color:#9b59b6; }
        .card-sm.expenses .amt { color:#f39c12; }
        .card-sm.balance .amt { color:#27ae60; }

        .grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:18px; }
        .panel { background:#fff; padding:16px; border-radius:10px; box-shadow:0 6px 14px rgba(0,0,0,0.05); }
        .panel h2 { margin-bottom:10px; font-size:1.05rem; color:#2c3e50; border-bottom:1px solid #eef2f6; padding-bottom:8px; }

        .chart-box { height:320px; position:relative; }

        .expense-row { display:flex; align-items:flex-start; gap:16px; }
        .expense-chart { width:260px; height:260px; }
        .custom-legend { display:flex; flex-direction:column; gap:8px; margin-top:6px; }
        .legend-item { display:flex; align-items:center; gap:8px; }
        .legend-swatch { width:18px; height:14px; border-radius:3px; }
        .legend-item span { font-size:13px; font-weight:600; }

        table { width:100%; border-collapse:collapse; margin-top:10px; }
        th, td { padding:10px 12px; border-bottom:1px solid #eaeaea; text-align:left; }
        th { background:#fbfdff; font-weight:700; color:#2c3e50; }
        tr:hover { background:#fbfbfc; }
        .highlight { background:#eef6ff; font-weight:700; }

        @media (max-width:900px) {
            .grid { grid-template-columns:1fr; }
            .summary { grid-template-columns:1fr; }
            .expense-row { flex-direction:row; flex-wrap:wrap; }
            .custom-legend { flex-direction:row; gap:10px; flex-wrap:wrap; }
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>Investment Dashboard</h1>
        <p>Tracking contributions and expenses (Jan-2023 → Oct-2025)</p>
    </header>

    <div class="summary">
        <div class="card-sm total">
            <h3>Total Investment</h3>
            <div class="amt" id="totalInvestment">₹0</div>
        </div>
        <div class="card-sm expenses">
            <h3>Total Expenses</h3>
            <div class="amt" id="totalExpenses">₹0</div>
        </div>
        <div class="card-sm balance">
            <h3>Available Balance</h3>
            <div class="amt" id="availableBalance">₹0</div>
        </div>
    </div>

    <div class="grid">
        <div class="panel">
            <h2>Monthly Contributions</h2>
            <div class="chart-box">
                <canvas id="contributionsChart"></canvas>
            </div>
        </div>

        <div class="panel">
            <h2>Expense Breakdown</h2>
            <div class="expense-row">
                <div class="expense-chart">
                    <canvas id="expensesChart"></canvas>
                </div>
                <div class="custom-legend" id="expenseLegend"></div>
            </div>
        </div>
    </div>

    <div class="panel">
        <h2>Investment Details</h2>
        <div style="overflow-x:auto;">
            <table id="investmentTable">
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Pankaj (₹)</th>
                        <th>Puneet (₹)</th>
                        <th>Lucky (₹)</th>
                        <th>Total (₹)</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<script>
/* ------------------ Full Investment Data (Jan-23 → Oct-25) ------------------ */
const investmentData = [
    { month: 'Jan-23', pankaj: 0, puneet: 0,    lucky: 20000, total: 20000, note: 'Pankaj Received 20000' },
    { month: 'Feb-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Mar-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Apr-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'May-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Jun-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Jul-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Aug-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Sep-23', pankaj: 0, puneet: 0,     lucky: 0,     total: 0 },
    { month: 'Oct-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Nov-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Dec-23', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },

    { month: 'Jan-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Feb-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Mar-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Apr-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'May-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Jun-24', pankaj: 0, puneet: 20000, lucky: 20000, total: 40000 },
    { month: 'Jul-24', pankaj: 0, puneet: 0,     lucky: 0,     total: 0 },
    { month: 'Aug-24', pankaj: 0, puneet: 0,     lucky: 0,     total: 0 },
    { month: 'Sep-24', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Oct-24', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Nov-24', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Dec-24', pankaj:15000, puneet:15000, lucky:15000, total:45000 },

    { month: 'Jan-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Feb-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Mar-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Apr-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'May-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Jun-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Jul-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Aug-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Sep-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 },
    { month: 'Oct-25', pankaj:15000, puneet:15000, lucky:15000, total:45000 }
];

/* ------------------ Expense Data ------------------ */
const expenseData = [
    { category: 'Shiwpur Khet Me', amount: 280000 },
    { category: 'Pankaj (Delhi Home Loan)', amount: 126000 },
    { category: 'Mitti', amount: 4000 },
    { category: 'Ghar ki Battery', amount: 3700 },
    { category: 'Ped ki katai', amount: 1300 }
];

/* Colors for legend & chart (5 items) */
const legendColors = ["#9b59b6", "#3498db", "#f39c12", "#8e44ad", "#5dade2"];

/* ---------------- Populate table ----------------- */
const tbody = document.querySelector('#investmentTable tbody');
investmentData.forEach(item => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
        <td>${item.month}</td>
        <td>${item.pankaj}${item.note ? ' (' + item.note + ')' : ''}</td>
        <td>${item.puneet}</td>
        <td>${item.lucky}</td>
        <td class="highlight">${item.total}</td>
    `;
    tbody.appendChild(tr);
});

/* ---------------- Calculate summaries ---------------- */
const investmentTotal = investmentData.reduce((s,it) => s + (it.total || 0), 0);
const expenseTotal = expenseData.reduce((s,it) => s + (it.amount || 0), 0);
const availableBalance = investmentTotal - expenseTotal;

document.getElementById('totalInvestment').textContent = '₹' + investmentTotal.toLocaleString();
document.getElementById('totalExpenses').textContent   = '₹' + expenseTotal.toLocaleString();
document.getElementById('availableBalance').textContent = '₹' + availableBalance.toLocaleString();

/* ---------------- Contributions Chart (bar) ---------------- */
const contribCtx = document.getElementById('contributionsChart').getContext('2d');
new Chart(contribCtx, {
    type: 'bar',
    data: {
        labels: investmentData.map(x => x.month),
        datasets: [
            { label: 'Pankaj', data: investmentData.map(x => x.pankaj), backgroundColor: 'rgba(52,152,219,0.8)' },
            { label: 'Puneet', data: investmentData.map(x => x.puneet), backgroundColor: 'rgba(46,204,113,0.8)' },
            { label: 'Lucky',  data: investmentData.map(x => x.lucky),  backgroundColor: 'rgba(231,76,60,0.8)' }
        ]
    },
    options: {
        responsive:true,
        maintainAspectRatio:false,
        scales: {
            x: { ticks: { maxRotation: 45, minRotation: 45 } },
            y: { beginAtZero:true, title: { display:true, text: 'Amount (₹)' } }
        },
        plugins: {
            legend: { position:'top' },
            title: { display:true, text: 'Monthly Contributions' },
            tooltip: { callbacks: { label: ctx => '₹' + Number(ctx.raw).toLocaleString() } }
        }
    }
});

/* ---------------- Expense Doughnut ---------------- */
const expCtx = document.getElementById('expensesChart').getContext('2d');
new Chart(expCtx, {
    type: 'doughnut',
    data: {
        labels: expenseData.map(e => e.category),
        datasets: [{
            data: expenseData.map(e => e.amount),
            backgroundColor: legendColors,
            borderColor: legendColors.map(c => c),
            borderWidth: 1
        }]
    },
    options: {
        responsive:true,
        maintainAspectRatio:false,
        plugins: {
            legend: { display:false }, // we use custom legend
            tooltip: {
                callbacks: {
                    label: function(context) {
                        const val = context.raw;
                        const total = expenseData.reduce((s,it) => s + it.amount, 0);
                        const pct = total ? ((val/total)*100).toFixed(1) : 0;
                        return `₹${val.toLocaleString()} (${pct}%)`;
                    }
                }
            },
            title: { display:true, text:'Expense Distribution' }
        }
    }
});

/* ---------------- Custom Legend: ONLY AMOUNT (small font, colored) ---------------- */
const legendBox = document.getElementById('expenseLegend');
legendBox.innerHTML = '';
expenseData.forEach((it, idx) => {
    const div = document.createElement('div');
    div.className = 'legend-item';
    div.innerHTML = `
        <div class="legend-swatch" style="background:${legendColors[idx]}"></div>
        <span style="color:${legendColors[idx]}">₹${it.amount.toLocaleString()}</span>
    `;
    legendBox.appendChild(div);
});
</script>
</body>
</html>
